<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>zange - ãƒ¦ãƒ¼ã‚¶ãƒ¼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="stylesheet" href="style.css" />
  <style>
    .follow-btn{
      font-size:12px; padding:2px 8px; margin-left:6px;
      border-radius:6px; border:1px solid #ddd; background:#fff; cursor:pointer;
      transition: all 0.2s ease;
    }
    .follow-btn.following{
      background:#2563eb; color:#fff; border-color:#2563eb;
    }
  </style>
</head>
<body>
  <header>
    <div style="display:flex; align-items:center; justify-content:space-between;">
      <h1><a href="index.html" style="text-decoration:none; color:inherit;">zange</a></h1>
      <span id="currentUserIcon"></span>
    </div>
  </header>

  <main id="userProfilePage" style="padding-bottom:90px">
    <div class="card form" id="userHeader"></div>
    <div class="card form" style="margin-top:16px">
      <div class="section-title">å…¬é–‹æŠ•ç¨¿</div>
      <div id="userPostsList" style="margin-top:10px"></div>
    </div>
  </main>

  <footer class="mobile-tabbar">
    <nav>
      <a href="index.html"><span class="icon">ğŸ </span><span class="label">ãƒ›ãƒ¼ãƒ </span></a>
      <a href="topics.html"><span class="icon">ğŸ¯</span><span class="label">ãŠé¡Œ</span></a>
      <a href="notifications.html" class="nav-link nav-bell">
        <span class="icon-row"><span class="icon">ğŸ””</span><span id="notifBadge" class="notif-badge" aria-label="æœªèª­é€šçŸ¥æ•°"></span></span>
        <span class="label">é€šçŸ¥</span>
      </a>
      <a href="settings.html"><span class="icon">âš™ï¸</span><span class="label">è¨­å®š</span></a>
      <a href="about.html"><span class="icon">ğŸ“•</span><span class="label">æ¦‚è¦</span></a>
    </nav>
  </footer>
  <a class="fab" href="post.html"><span class="emoji">ğŸ™</span></a>

  <script src="script.js"></script>
  <script>
    /* ===== follow utils ===== */
    function getFollowees(){ try{ return JSON.parse(localStorage.getItem('followees')||'[]') }catch(_){ return [] } }
    function setFollowees(list){ localStorage.setItem('followees', JSON.stringify(list||[])) }
    function isFollowing(name){ return getFollowees().includes(name) }
    function toggleFollow(name){
      let list=getFollowees();
      if(isFollowing(name)){
        list=list.filter(n=>n!==name);
      } else {
        list.push(name);
      }
      setFollowees(list);
    }
    function renderFollowButton(author){
      if(!author) return '';
      const on=isFollowing(author);
      return `<button class="follow-btn ${on?'following':''}" data-follow-name="${author}">${on?'ãƒ•ã‚©ãƒ­ãƒ¼ä¸­':'ãƒ•ã‚©ãƒ­ãƒ¼'}</button>`;
    }

    /* ===== render user header ===== */
    function renderUserHeader(user){
      const el=document.getElementById('userHeader');
      el.innerHTML = `
        <div style="display:flex; align-items:center; gap:10px;">
          <img src="${user.icon||'default.png'}" alt="" style="width:50px;height:50px;border-radius:50%;">
          <div>
            <div style="font-weight:bold">${user.name||'åŒ¿å'} ${renderFollowButton(user.name||'åŒ¿å')}</div>
            <div style="color:#666;font-size:13px;">${user.bio||''}</div>
          </div>
        </div>`;
    }

    /* ===== render posts ===== */
    function renderUserPosts(posts){
      const wrap=document.getElementById('userPostsList');
      wrap.innerHTML='';
      posts.forEach(p=>{
        const div=document.createElement('div');
        div.className='card';
        div.style.marginBottom='10px';
        div.innerHTML=`
          <div style="font-size:15px; line-height:1.6">${p.text||''}</div>
          <div style="font-size:12px; color:#666; margin-top:6px">
            by ${p.author||'åŒ¿å'} ${renderFollowButton(p.author||'åŒ¿å')}
          </div>`;
        wrap.appendChild(div);
      });
    }

    /* ===== main ===== */
    (function main(){
      // ä»®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—æƒ³å®šï¼‰
      const user={ name:'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼', bio:'è‡ªå·±ç´¹ä»‹æ–‡ã§ã™ã€‚', icon:'photo/sample.jpg' };
      const posts=[
        { id:1, text:'æ˜¨æ—¥ãƒãƒ†ãƒé£Ÿã¹éããŸâ€¦', author:'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼' },
        { id:2, text:'ä¸Šå¸ã«è¬ã‚Œãªã‹ã£ãŸ', author:'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼' }
      ];

      renderUserHeader(user);
      renderUserPosts(posts);
    })();

    /* ===== follow button toggle ===== */
    document.addEventListener('click',(e)=>{
      const btn=e.target.closest('.follow-btn'); if(!btn) return;
      const name=btn.getAttribute('data-follow-name');
      toggleFollow(name);
      // ãƒšãƒ¼ã‚¸å…¨ä½“ã®ãƒ•ã‚©ãƒ­ãƒ¼ãƒœã‚¿ãƒ³ã‚’å†æç”»
      document.querySelectorAll(`[data-follow-name="${name}"]`).forEach(el=>{
        el.outerHTML=renderFollowButton(name);
      });
    });
  </script>
</body>
</html>
